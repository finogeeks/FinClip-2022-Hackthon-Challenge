(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/user"],{"2fa6":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n("a34a")),o=c(n("6b0c")),a=n("2f62");function c(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void n(s)}i.done?t(u):Promise.resolve(u).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)}))}}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){n.e("components/mix-list-cell").then(function(){return resolve(n("cebe"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/common/copyright").then(function(){return resolve(n("749f"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/common/contact").then(function(){return resolve(n("5f19"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/common/share").then(function(){return resolve(n("2e5b"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/common/user-info").then(function(){return resolve(n("4af6"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/common/user-profile").then(function(){return resolve(n("297e"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/common/user-phone").then(function(){return resolve(n("775d"))}.bind(null,n)).catch(n.oe)},w=0,x=0,y=!0,P={components:{listCell:d,copyright:h,contact:p,share:g,userInfo:v,userProfile:m,userPhone:b},data:function(){return{coverTransform:"translateY(0px)",coverTransition:"0s",moving:!1,active_bonus:0}},computed:l({},(0,a.mapState)(["page","layout","theme","userInfo","editionSetting","pageSize"])),onLoad:function(){var e=this;return u(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.theme){t.next=3;break}return t.next=3,e.$util.loadSetting();case 3:return console.log("theme:",e.theme),e.editionSetting["enable_live"]?e.setTabBarIndex(4,e.layout,e.theme):e.setTabBarIndex(3,e.layout,e.theme),t.next=7,e.loadPageSetting();case 7:return t.next=9,e.loadData();case 9:case"end":return t.stop()}}),t)})))()},onShow:function(){var e=this;return u(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadData();case 2:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){var t=this;return u(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("下拉刷新"),n.next=3,t.loadData();case 3:e.stopPullDownRefresh();case 4:case"end":return n.stop()}}),n)})))()},methods:{loadPageSetting:function(){var t=this;return u(r.default.mark((function n(){var o,a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("loadPageSetting"),o=t.$mp.page.route,console.log("path:",o),console.log("page:",t.page),a=t.page.filter((function(e){return e.path==o})),console.log("setting:",a),e.setNavigationBarTitle({title:a[0].title});case 7:case"end":return n.stop()}}),n)})))()},loadData:function(){var e=this;return u(r.default.mark((function t(){var n;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apis.auth.getUserInfo();case 2:return n=t.sent,t.next=5,e.$apis.auth.pointConfig();case 5:n=t.sent,console.log("res:",n),e.active_bonus=n.data.active_bonus;case 8:case"end":return t.stop()}}),t)})))()},getUserInfo:function(e){var t=this;return u(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("getUserInfo"),console.log(e),console.log(e.detail),console.log(e.detail.errMsg),console.log(e.detail.userInfo),console.log(e.detail.rawData),console.log(e.detail.iv),console.log(e.detail.encryptedData),o={data:e.detail.encryptedData,iv:e.detail.iv},n.next=11,t.$apis.auth.getUserInfoFromApi(o);case 11:case"end":return n.stop()}}),n)})))()},refreshUserInfo:function(e){var t=this;return u(r.default.mark((function n(){var o,a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("refreshUserInfo"),console.log(e),console.log(e.detail),console.log(e.detail.errMsg),console.log(e.detail.userInfo),console.log(e.detail.rawData),console.log(e.detail.iv),console.log(e.detail.encryptedData),o={data:e.detail.encryptedData,iv:e.detail.iv},n.next=11,t.$apis.auth.getUserInfoFromApi(o);case 11:a=n.sent,console.log("refreshed:",a),a?t.$helper.msg("已更新资料"):t.$helper.msg("更新资料失败");case 14:case"end":return n.stop()}}),n)})))()},getUserProfile:function(e){return u(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("getUserProfile");case 1:case"end":return e.stop()}}),e)})))()},getPhoneNumber:function(e){var t=this;return u(r.default.mark((function n(){var o,a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("getPhoneNumber"),console.log(e),console.log(e.detail.iv),console.log(e.detail.encryptedData),e.detail.iv&&e.detail.encryptedData){n.next=6;break}return n.abrupt("return");case 6:return o={data:e.detail.encryptedData,iv:e.detail.iv},n.next=9,t.$apis.auth.bindUserPhone(o);case 9:return a=n.sent,console.log("res:",a),n.next=13,t.$apis.auth.getUserInfo();case 13:a=n.sent,console.log("res:",a);case 15:case"end":return n.stop()}}),n)})))()},refreshUserProfile:function(e){return u(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("refreshUserProfile");case 1:case"end":return e.stop()}}),e)})))()},navToMember:function(t){if(!this.userInfo.is_member)return this.$helper.msg("请先注册会员"),t="/pages/member/register",void setTimeout((function(){e.navigateTo({url:t})}),800);e.navigateTo({url:t})},navTo:function(t){e.navigateTo({url:t})},clearStorage:function(){var t=this;try{e.clearStorageSync(),o.default.commit({type:"clearJwt"}),this.$helper.msg("缓存已清除"),setTimeout((function(){t.loadData()}),800)}catch(n){console.log("clearStorage error:",n),this.$helper.msg("缓存清除失败，请稍候重试")}},activeMember:function(){var e=this;return u(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("activeMember"),e.userInfo.nickName){t.next=6;break}return e.$helper.msg("请允许获取你的昵称、头像、地区及性别"),t.next=5,e.getUserProfile();case 5:return t.abrupt("return");case 6:e.getPhoneNumber();case 7:case"end":return t.stop()}}),t)})))()},coverTouchstart:function(e){!1!==y&&(this.coverTransition="transform .1s linear",w=e.touches[0].clientY)},coverTouchmove:function(e){x=e.touches[0].clientY;var t=x-w;t<0?this.moving=!1:(this.moving=!0,t>=80&&t<100&&(t=80),t>0&&t<=80&&(this.coverTransform="translateY(".concat(t,"px)")))},coverTouchend:function(){!1!==this.moving&&(this.moving=!1,this.coverTransition="transform 0.3s cubic-bezier(.21,1.93,.53,.64)",this.coverTransform="translateY(0px)")}}};t.default=P}).call(this,n("543d")["default"])},"4ae9":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));var o=function(){var e=this,t=e.$createElement;e._self._c},a=[]},"4f2a":function(e,t,n){},"5a14":function(e,t,n){"use strict";n.r(t);var r=n("4ae9"),o=n("ee74");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("d9c8");var c,i=n("f0c5"),u=Object(i["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],c);t["default"]=u.exports},c090:function(e,t,n){"use strict";(function(e){n("2968");r(n("66fd"));var t=r(n("5a14"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},d9c8:function(e,t,n){"use strict";var r=n("4f2a"),o=n.n(r);o.a},ee74:function(e,t,n){"use strict";n.r(t);var r=n("2fa6"),o=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a}},[["c090","common/runtime","common/vendor"]]]);