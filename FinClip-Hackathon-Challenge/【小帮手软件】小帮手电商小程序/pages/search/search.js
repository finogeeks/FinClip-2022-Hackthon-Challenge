(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"13de":function(e,t,o){"use strict";var n=o("fb84"),r=o.n(n);r.a},2880:function(e,t,o){"use strict";var n=o("505c"),r=o.n(n);r.a},4925:function(e,t,o){"use strict";o.r(t);var n=o("6c4d"),r=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},"505c":function(e,t,o){},"6c08":function(e,t,o){"use strict";var n=o("a3a4"),r=o.n(n);r.a},"6c4d":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("a34a")),r=o("2f62");function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,o,n,r,i,a){try{var c=e[i](a),s=c.value}catch(l){return void o(l)}c.done?t(s):Promise.resolve(s).then(n,r)}function c(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function c(e){a(i,n,r,c,s,"next",e)}function s(e){a(i,n,r,c,s,"throw",e)}c(void 0)}))}}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function l(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){d(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var u=function(){o.e("components/mehaotian-search-revision/mehaotian-search-revision").then(function(){return resolve(o("d060"))}.bind(null,o)).catch(o.oe)},f=function(){o.e("components/uni-load-more/uni-load-more").then(function(){return resolve(o("0589"))}.bind(null,o)).catch(o.oe)},h=function(){o.e("components/common/copyright").then(function(){return resolve(o("749f"))}.bind(null,o)).catch(o.oe)},p=function(){o.e("components/common/list-goods").then(function(){return resolve(o("4a25"))}.bind(null,o)).catch(o.oe)},g={components:{mSearch:u,uniLoadMore:f,copyright:h,listGoods:p},data:function(){return{defaultKeyword:"",keyword:"",oldKeywordList:[],hotKeywordList:[],keywordList:[],forbid:"",isShowKeywordList:!1,isShowList:!1,isShowHotKeyword:!1,headerPosition:"fixed",headerTop:"0px",filterIndex:0,cateId:0,priceOrder:0,goodsList:[],pageNo:1,loadingType:"more",pageTitle:""}},computed:l({},(0,r.mapState)(["pageSize","theme","shareCode"])),onLoad:function(t){var o=this;return c(n.default.mark((function r(){return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),""!==o.theme){n.next=4;break}return n.next=4,o.$util.loadSetting();case 4:if(console.log("theme:",o.theme),o.init(),console.log("options:",t),o.cateId=t.tid,t.title&&(o.pageTitle=t.title,e.setNavigationBarTitle({title:t.title})),0===o.pageTitle.length&&e.hideShareMenu(),o.keyword=t.keyword,!o.cateId&&!o.keyword){n.next=15;break}return o.isShowList=!0,n.next=15,o.loadData(!0);case 15:case"end":return n.stop()}}),r)})))()},onPullDownRefresh:function(){var t=this;return c(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return console.log("下拉刷新"),o.next=3,t.loadData(!0);case 3:e.stopPullDownRefresh();case 4:case"end":return o.stop()}}),o)})))()},onReachBottom:function(){var e=this;return c(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("上拉加载"),t.next=3,e.loadData();case 3:case"end":return t.stop()}}),t)})))()},onShareAppMessage:function(e){return"button"===e.from&&(console.log("来自页面内分享按钮"),console.log(e.target)),console.log("pageTitle",this.pageTitle),{title:this.pageTitle,path:"/pages/search/search?share_code=".concat(this.shareCode,"&tid=").concat(this.cateId,"&title=").concat(this.pageTitle)}},methods:{init:function(){this.loadDefaultKeyword(),this.loadOldKeyword(),this.loadHotKeyword()},blur:function(){e.hideKeyboard()},searchBoxFocus:function(){console.log("searchBoxFocus"),this.isShowList=!1},loadDefaultKeyword:function(){this.defaultKeyword=""},loadOldKeyword:function(){var t=this;e.getStorage({key:"OldKeys",success:function(e){var o=JSON.parse(e.data);t.oldKeywordList=o}})},loadHotKeyword:function(){this.hotKeywordList=["键盘","鼠标","显示器","电脑主机","蓝牙音箱","笔记本电脑","鼠标垫","USB","USB3.0"]},inputChange:function(e){var t=e.detail?e.detail.value:e;if(!t)return this.keywordList=[],void(this.isShowKeywordList=!1)},drawCorrelativeKeyword:function(e,t){for(var o=e.length,n=[],r=0;r<o;r++){var i=e[r],a=i[0].replace(t,"<span style='color: #9f9f9f;'>"+t+"</span>");a="<div>"+a+"</div>";var c={keyword:i[0],htmlStr:a};n.push(c)}return n},setKeyword:function(e){this.keyword=this.keywordList[e].keyword},oldDelete:function(){var t=this;e.showModal({content:"确定清除历史搜索记录？",success:function(o){o.confirm?(console.log("用户点击确定"),t.oldKeywordList=[],e.removeStorage({key:"OldKeys"})):o.cancel&&console.log("用户点击取消")}})},hotToggle:function(){this.forbid=this.forbid?"":"_forbid"},doSearch:function(e){e=!1===e?this.keyword:e,e||(e=this.defaultKeyword),this.keyword=e,e&&(this.saveKeyword(e),this.isShowList=!0,this.loadData(!0))},cancelSearch:function(){console.log("cid:",this.cid),this.cateId?(console.log("分类页，取消搜索重新刷新"),this.keyword="",this.isShowList=!0,this.loadData(!0)):(console.log("搜索页，取消搜索返回首页"),e.switchTab({url:"/pages/index/index"}))},saveKeyword:function(t){var o=this;e.getStorage({key:"OldKeys",success:function(n){var r=JSON.parse(n.data),i=r.indexOf(t);-1==i||r.splice(i,1),r.unshift(t),r.length>10&&r.pop(),e.setStorage({key:"OldKeys",data:JSON.stringify(r)}),o.oldKeywordList=r},fail:function(n){var r=[t];e.setStorage({key:"OldKeys",data:JSON.stringify(r)}),o.oldKeywordList=r}})},loadData:function(e){var t=this;return c(n.default.mark((function o(){var r,i;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(console.log("loadData"),t.loadDefaultKeyword(),t.cateId||t.keyword){o.next=4;break}return o.abrupt("return");case 4:if(e&&(console.log("refresh"),t.goodsList=[],t.loadingType="loading",t.pageNo=1),"noMore"!==t.loadingType){o.next=8;break}return console.log("noMore"),o.abrupt("return");case 8:return 0===t.filterIndex&&(r=""),1===t.filterIndex&&(r="-quantity_sale"),2===t.filterIndex&&1===t.priceOrder&&(r="+price_low"),2===t.filterIndex&&2===t.priceOrder&&(r="-price_low"),console.log("sort:",r),o.next=15,t.$apis.productList(t.cateId,t.keyword,t.pageSize,t.pageNo,r);case 15:i=o.sent,console.log("list:",i),t.goodsList=t.goodsList.concat(i.data.items),console.log("goodsList:",t.goodsList),t.pageNo>=i.data.page_count?t.loadingType="noMore":(t.loadingType="more",t.pageNo++);case 20:case"end":return o.stop()}}),o)})))()},tabClick:function(t){this.filterIndex===t&&2!==t||(this.filterIndex=t,this.priceOrder=2===t?1===this.priceOrder?2:1:0,e.pageScrollTo({duration:300,scrollTop:0}),this.loadData(!0))}}};t.default=g}).call(this,o("543d")["default"])},a3a4:function(e,t,o){},b310:function(e,t,o){"use strict";o.r(t);var n=o("dc9d"),r=o("4925");for(var i in r)"default"!==i&&function(e){o.d(t,e,(function(){return r[e]}))}(i);o("6c08"),o("13de"),o("2880");var a,c=o("f0c5"),s=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);t["default"]=s.exports},bac1:function(e,t,o){"use strict";(function(e){o("2968");n(o("66fd"));var t=n(o("b310"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},dc9d:function(e,t,o){"use strict";o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}));var n={uniLoadMore:function(){return o.e("components/uni-load-more/uni-load-more").then(o.bind(null,"0589"))}},r=function(){var e=this,t=e.$createElement;e._self._c},i=[]},fb84:function(e,t,o){}},[["bac1","common/runtime","common/vendor"]]]);